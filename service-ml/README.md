# service-ml

## Краткое описание 

Лёгкий микросервис для ML-инференса инстанс-сегментации дефектов сварных швов.  
Принимает сырые байты изображений (JPEG/PNG) через Kafka, выполняет предсказание выбранной модели и возвращает аннотированное изображение.

## Структура на текущий момент 

service-ml/
├── README.md
├── Dockerfile
├── docker-compose.yml
├── requirements.txt
├── datasets/
│   ├── unetpp-format/      
│   │   └── .gitkeep
│   └── yolo-format/        
│       ├── images/
│       │   ├── train/
│       │   └── val/
│       └── labels/
│           ├── train/
│           └── val/
├── models/ # Вся информация по каждой модели: лучшие веса, графики изменения лосса и прочее
│   └── yolo11n-baseline/   # базовая модель YOLOv11n-seg 
│       ├── metrics/        # лог метрик обучения
│       │   └── .gitkeep
│       └── weights/        # веса модели
│           └── yolov11n-baseline.pt
├── notebooks/ # Ноутбуки с обучением / экспериментами. Ноутбук с обучением должен содержать всё необходимое: от организации датасета под конкретную модель до расфасовки артефактов моделей по нужным папкам.
│   └── yolo-baseline.ipynb
└── src/
    ├── inference.py        # подписка на Kafka и публикация аннотированных изображений
    ├── model.py            # загрузка модели и метод predict()
    └── utils.py            # конвертация байтов ↔ Image, отрисовка bbox и масок